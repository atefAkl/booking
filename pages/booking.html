<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>TRIPVUM</title>
    <link rel="shortcut icon" href="../images/favicon.png" type="image/x-icon">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-QWTKZyjpPEjISv5WaRU9OFeRpok6YctnYmDr5pNlyT2bRjXh0JMhjY6hW+ALEwIH" crossorigin="anonymous">
    <link rel="stylesheet" href="../css/all.css">
    <link rel="stylesheet" href="../css/style.css">
    <link rel="stylesheet" href="../css/booking.css">
    <script src="https://code.jquery.com/jquery-3.7.1.min.js" integrity="sha256-/JqT3SQfawRcv/BIHPThkBvs0OEvtFFmqPF/lYI/Cxo=" crossorigin="anonymous"></script>

  </head>
  <body dir="rtl">
    <header>
      <nav class="navbar navbar-expand-lg">
        <div class="container">
          <a class="navbar-brand" data-bs-toggle="tooltip" title="Ù…ÙˆÙ‚Ø¹ Ø­Ø¬Ø² Ø±Ø­Ù„Ø§Øª Ø§Ù„Ø·ÙŠØ±Ø§Ù† Ø§Ù„Ø¯Ø§Ø®Ù„Ù‰" href="/index.html">
            <img class="d-block" src="../images/icon.png" height="40" alt="">
            <img class="d-block" src="../images/tripvum.png" height="12" alt="">
          </a>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarSupportedContent" aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
            <span class="navbar-toggler-icon"></span>
          </button>
          <div class="collapse navbar-collapse" id="navbarSupportedContent">
            <ul class="navbar-nav m-auto mb-2 mb-lg-0">
              <li class="nav-item">
                <a class="nav-link active" aria-current="page" href="/index.html">
                  <i class="fa fa-home"></i> &nbsp; Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ©</a>
              </li>
              <li class="nav-item">
                <a class="nav-link" aria-current="page" href="#">
                  <i class="fas fa-clipboard-check"></i> &nbsp; Ø§Ù„Ø­Ø¬Ø²</a>
              </li>
              <li class="nav-item">
                <a class="nav-link" aria-current="page" href="#">
                  <i class="fas fa-suitcase-rolling"></i> &nbsp; Ø±Ø­Ù„Ø§Øª</a>
              </li>
              <li class="nav-item">
                <a class="nav-link" aria-current="page" href="#">
                  <i class="fas fa-hotel"></i>  &nbsp;  Ø¥Ù‚Ø§Ù…Ø©</a>
              </li><li class="nav-item">
                <a class="nav-link" aria-current="page" href="#">
                  <i class="fas fa-plane"></i>  &nbsp;  Ø·ÙŠØ±Ø§Ù†</a>
              </li><li class="nav-item">
                <a class="nav-link" aria-current="page" href="#">
                  <i class="fas fa-star-half-alt"></i> &nbsp; ØªÙ‚ÙŠÙŠÙ…Ø§Øª</a>
              </li>
              <li class="nav-item">
                <a class="nav-link" aria-current="page" href="#">
                  <i class="fas fa-id-card"></i> &nbsp; Ø§ØªØµÙ„ Ø¨Ù†Ø§</a>
              </li>
            </ul>
            <!-- Button trigger modal -->
            <div class="user">
              <div class="user-buttons">
                <button type="button" class="btn btn-outline-light btn-sm" data-bs-toggle="modal" data-bs-target="#loginFormModal">
                  Ø§Ù„Ø¯Ø®ÙˆÙ„
                </button>
                <button type="button" class="btn btn-outline-light btn-sm" data-bs-toggle="modal" data-bs-target="#registerModal">
                  Ø§Ù„ØªØ³Ø¬ÙŠÙ„
                </button>
              </div>
              <div id="user-menu" class="user-menu hidden">
                <button class="btn text-light "> &nbsp; <i class="fa fa-user"></i>&nbsp; Ù…Ø±Ø­Ø¨Ø§  <span class="username"></span></button>
                <ul class="hidden">
                  <li>
                    <a href="">Ø­Ø³Ø§Ø¨ Ø´Ø®ØµÙ‰</a>
                  </li>
                  <li>
                      <a href="">Ø§Ù„Ù…ÙØ¶Ù„Ø©</a>
                  </li>
                  <li>
                    <a href="">Ø±Ø­Ù„Ø§Øª</a>
                  </li>
                  <li>
                    <a href="">Ø­Ø¬ÙˆØ²Ø§Øª</a>
                  </li>
                  <li>
                    <a id="logout">Ø®Ø±ÙˆØ¬</a>
                  </li>
                </ul>
              </div>
            </div>
          </nav>
        </div>
      </div>
    </header>


    <section class="booking-header" style="background: url('../images/booking-header.jpeg'); background-size: 100%; background-position: left 30%; height: 200px">

    </section>


    <!-- Booking form -->
    <section id="booking-section" class="w-100">
      <div class="booking  rounded-2 px-5 py-3">
         <nav>
            <div class="nav nav-tabs" id="nav-tab"  role="tablist" style="border: 0">
                <button class="nav-link active" id="nav-booking-tab" data-bs-toggle="tab" data-bs-target="#nav-booking" type="button" role="tab" aria-controls="nav-booking" aria-selected="true">Ø­Ø¬Ø² Ø·ÙŠØ±Ø§Ù†</button>
                
                <button class="nav-link" id="nav-hotels-tab" data-bs-toggle="tab" data-bs-target="#nav-hotels" type="button" role="tab" aria-controls="nav-hotels" aria-selected="false">Ø§Ù„ÙÙ†Ø§Ø¯Ù‚</button>
                <button class="nav-link" id="nav-trips-tab" data-bs-toggle="tab" data-bs-target="#nav-trips" type="button" role="tab" aria-controls="nav-trips" aria-selected="false">Ø§Ù„Ø±Ø­Ù„Ø§Øª</button>
                <button class="nav-link" id="nav-cars-tab" data-bs-toggle="tab" data-bs-target="#nav-cars" type="button" role="tab" aria-controls="nav-cars" aria-selected="false">Ø³ÙŠØ§Ø±Ø§Øª</button>
            </div>
        </nav>
        <div class="tab-content" id="nav-tabContent" style="background-color: #fff">
            <div class="tab-pane fade show active" id="nav-booking" role="tabpanel" aria-labelledby="nav-booking-tab" tabindex="0">
              <form class="px-4 py-3" action="./pages/booking.html" method="GET">
                
                <div class="input-group">
                  <input disabled style="background-color: #fff !important;" type="text" class="form-control border-0" value="ØªØ§Ø±ÙŠØ® Ø§Ù„Ø±Ø­Ù„Ø©: ">  
                  <input disabled style="background-color: #fff !important;" type="text" class="form-control border-0" value="Ø§Ù„Ø­Ø¬Ø² Ù…Ù†: ">  
                  <input disabled style="background-color: #fff !important;" type="text" class="form-control border-0" value="Ø§Ù„ÙˆØ¬Ù‡Ø©: ">  
                </div>
                <div class="input-group">
                  <!-- <label for="go" class="input-group-text">ØªØ§Ø±ÙŠØ® Ø§Ù„Ø±Ø­Ù„Ø©</label> -->
                  <input class="form-control" name="go" type="date" id="go" >  
                  <!-- <label for="from" class="input-group-text">Ø§Ù„Ø­Ø¬Ø² Ù…Ù†:</label> -->
                  <select class="form-control" name="departure" type="date" id="departure"></select>  
                  <!-- <label for="destination" class="input-group-text">Ø§Ù„ÙˆØ¬Ù‡Ø©:</label> -->
                  <select class="form-control" name="destination" type="date" id="destination"></select>
                    <button type="submit" id="search_flights" class="input-group-text">Ø§Ù„Ø¨Ø­Ø«</button>
                </div>
              </form>

            </div>
            <div class="tab-pane fade" id="nav-trips" role="tabpanel" aria-labelledby="nav-trips-tab" tabindex="0">
              trips</div>
            <div class="tab-pane fade" id="nav-hotels" role="tabpanel" aria-labelledby="nav-hotels-tab" tabindex="0">
              hotels</div>
            <div class="tab-pane fade" id="nav-cars" role="tabpanel" aria-labelledby="nav-cars-tab" tabindex="0">
              cars</div>
          </div>
        
    </section>


    <section class="flights-list" dir="rtl">
        <div class="container">
            <div id="filters" style="min-height: 100vh; background: #fff;" class="w-75">
                <div class="filters-header">
                  Ù†ØªØ§Ø¦Ø¬ Ø§Ù„Ø¨Ø­Ø«
                  </div>
                  <div id="search-result" class="px-3">

                  </div>
            </div>
            <div id="filters" style="height: 100vh; background: #fff;" class="w-25">
                <div class="filters-header">
                    ÙÙ„ØªØ±Ø© Ø§Ù„Ù†ØªØ§Ø¦Ø¬
                </div>
            </div>
        </div>


    </section>

    <!-- Modals -->

    <!-- Login Form -->
    <div class="modal fade" id="loginFormModal" tabindex="-1" aria-labelledby="loginFormLabel" aria-hidden="true">
      <div class="modal-dialog">
        <div class="modal-content">
         
          <div class="modal-header p-1 px-3">
            <h3 class="modal-title" id="loginFormLabel">ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„</h3>
            <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
          </div>
          <div class="modal-body">
            <div class="input-group mb-2">
              <label for="email" class="input-group-text">Ø§Ø³Ù… Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…: </label>
              <input class="form-control" type="email" id="email">
            </div>
            <div class="input-group mb-2">
              <label for="password" class="input-group-text">ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ±: </label>
              <input class="form-control" type="password" id="password">
            </div>
                    
            <div class="input-group mb-2" dir="rtl">
              <label class="input-group-text" for="">
                <input type="checkbox" id="btn-check" autocomplete="off">
              </label>
            <label class="input-group-text" for="btn-check">ØªØ°ÙƒØ±Ù†Ù‰</label>

            </div>
            
            <div class="input-group row m-auto">
              <button type="button" class="btn btn-m btn-outline-secondary col-6" data-bs-dismiss="modal">Ø§Ù„ØºØ§Ø¡</button>
              <button type="button" id="submitLogin" class="btn btn-m btn-outline-primary col-6">ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„</button>
            </div>

          </div>
          <div class="modal-footer py-1 px-3">
            <p>Ù†Ø³ÙŠØª ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ±ØŸ <a href="./reset.password.html">Ø§Ø­ØµÙ„ Ø¹Ù„Ù‰ ÙƒÙ„Ù…Ø© Ù…Ø±ÙˆØ± Ø¬Ø¯ÙŠØ¯Ø©</a></p>
            <p>Ù„ÙŠØ³ Ù„Ø¯ÙŠÙƒ Ø­Ø³Ø§Ø¨ØŸ ÙŠÙ…ÙƒÙ†Ùƒ  
              <button type="button" class="btn btn-outline-light btn-sm" data-bs-toggle="modal" data-bs-target="#registerModal">
                  Ø§Ù„ØªØ³Ø¬ÙŠÙ„
                </button> ÙÙ‰ Ø§Ù„Ù…ÙˆÙ‚Ø¹.
            </p>
            <p></p>
          </div>
        </div>
        
      </div>
    </div>

    <!-- Register Form -->
    <div class="modal fade" id="registerModal" tabindex="-1" aria-labelledby="registerModalLabel" aria-hidden="true">
      <div class="modal-dialog">
        <div class="modal-content">
         
          <div class="modal-header p-1 px-3">
            <h3 class="modal-title" id="registerModalLabel">ØªØ³Ø¬ÙŠÙ„ Ø­Ø³Ø§Ø¨ Ø¬Ø¯ÙŠØ¯</h3>
            <button type="button" class="btn-close text-light" data-bs-dismiss="modal" aria-label="Close"><i class="fa fa-times text-light"></i></button>
          </div>
          <div class="modal-body">
            <div id="register-form">
                <div class="input-group mb-2">
                    <label for="username" class="input-group-text">Ø§Ø³Ù… Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…:</label>
                    <input type="text" id="reg_username" placeholder="Ù…Ø­Ù…Ø¯ Ø£Ø­Ù…Ø¯" class="form-control">
                </div>
                <div class="input-group mb-2">
                    <label for="email" class="input-group-text">Ø§Ù„Ø¨Ø±ÙŠØ¯ Ø§Ù„Ø§Ù„ÙƒØªØ±ÙˆÙ†ÙŠ:</label>
                    <input type="email" id="reg_email" placeholder="abcd@website.ext" class="form-control">
                </div>
                <div class="input-group mb-2">
                    <label for="password" class="input-group-text">ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ±:</label>
                    <input type="password" id="reg_password" placeholder="ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ±" class="form-control">
                    <input type="password" id="reg_cPassword" placeholder="ØªØ£ÙƒÙŠØ¯ ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ±" class="form-control">
                </div>
                <div class="input-group row m-auto">
                  <button type="button" class="btn btn-m btn-outline-secondary col-6" data-bs-dismiss="modal">Ø§Ù„ØºØ§Ø¡</button>
                  <button type="submit" id="submit-register" class="btn btn-m btn-outline-primary col-6"><span class="ss">Ø§Ù„ØªØ³Ø¬ÙŠÙ„</span></button>
                </div>
            </div>

          </div>
          <div class="modal-footer py-1 px-3">
            <p>Ù„Ø¯ÙŠÙƒ Ø­Ø³Ø§Ø¨ Ù…Ø³Ø¬Ù„ Ø¨Ø§Ù„ÙØ¹Ù„ØŸ &nbsp; 
              <button type="button" class="btn btn-outline-light btn-sm" data-bs-toggle="modal" data-bs-target="#loginFormModal">
                ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„
              </button></p>
            <p></p>
          </div>
        </div>
      </div>
    </div>
<button type="button" class="btn btn-primary hidden" id="liveToastBtn">Show live toast</button>

    <!-- alerts -->
    <div class="toast-container position-fixed bottom-0 start-0 p-3">
      <div id="liveToast"  style="z-index: 99999;" class="toast registerError" role="alert" aria-live="assertive" aria-atomic="true">
        <div class="toast-header">
          <span class="rounded me-2 bg-primary"></span>
          <strong class="me-auto">Ù…ÙˆÙ‚Ø¹ TRIPVUM</strong>
          <button type="button" class="btn-close" data-bs-dismiss="toast" aria-label="Close"></button>
        </div>

        <div class="toast-body">
          <div id="errMessage">
            Lorem ipsum, dolor sit amet consectetur adipisicing elit. Vitae, obcaecati quos. Consequatur.
          </div>
          <!-- <div class="mt-2 pt-2 border-top">
            <button type="button" class="btn btn-primary btn-sm">Take action</button>
            <button type="button" class="btn btn-secondary btn-sm" data-bs-dismiss="toast">Close</button>
          </div> -->
        </div>
      </div>
    </div>



    <div class="result-info-section" id="info-section">
      <div class="container">
        <div class="card mt-5 w-75 m-auto">
          <div class="card-header">
            <h5>Ù…Ø¹Ù„ÙˆÙ…Ø§Øª Ø§Ù„Ø±Ø­Ù„Ø©</h5>
            
            <span id="close-result-info" class="close" data-bs-dismiss="#info-section"><i class="fa fa-times"></i></span>
          </div>
          <div class="card-body">
            <h5 class="card-title">Special title treatment</h5>
            <p class="card-text">With supporting text below as a natural lead-in to additional content.</p>
            
          </div>
          <div class="card-footer">
            <div class="input-group" dir="rtl">
              <label class="input-group-text"><a href="">Ø§ÙƒÙ…Ø§Ù„ Ø§Ù„Ø­Ø¬Ø²</a></label>
              <label class="input-group-text"><a href="#">Ø§Ù„Ø°Ù‡Ø§Ø¨ Ø§Ù„Ù‰ Ù…ÙˆÙ‚Ø¹ Ù…Ø²ÙˆØ¯ Ø§Ù„Ø®Ø¯Ù…Ø©</a></label>
              <label class="input-group-text"><a href="#">Ø§Ù„Ø¨Ø­Ø« Ø¹Ù† Ø±Ø­Ù„Ø© Ø£Ø®Ø±Ù‰</a></label>
            </div>
          </div>
        </div>
      </div>
    </div>
    <script src="https://unpkg.com/swiper@8/swiper-bundle.min.js"></script>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js" integrity="sha384-YvpcrYf0tY3lHB60NNkmXc5s9fDVZLESaAA55NDzOxhy9GkcIdslK1eN7N6jIeHz" crossorigin="anonymous"></script>
    <script src="../js/main.js"></script>
    <script src="../js/register.js"></script>
    <script src="../js/data.js"></script>

    <script>
      const urlParams = new URLSearchParams(window.location.search);
      $('#go').val(urlParams.get('go'))
      airports.forEach ((ap)=>{
        $('#departure').append(`<option ${urlParams.get('departure') == ap.id ? 'selected' : ''} value="${ap.id}">${ap.name}</option>`)
        $('#destination').append(`<option ${urlParams.get('destination') == ap.id ? 'selected' : ''} value="${ap.id}">${ap.name}</option>`)

      })


      const departure = airports.find((ap)=>ap.id == urlParams.get('departure'))
      const destination = airports.find((ap)=>ap.id == urlParams.get('destination'))
      const departure_date = urlParams.get('go')
      const found_fights = []

      airlines.forEach((al, i)=>{
        found_fights.push({
          flight_id: ++i,
          departure: departure,
          destination: destination,
          departure_date: departure_date
        })
      })
const indexes = []
      for (let i = 0; i<100; i++){
        let index = Math.floor(Math.random()*100)
        indexes.push(index)
      }
      const now = new Date()
      
      function getDayName(date){
        return date.getDay()
      }

      // ÙÙ„ØªØ±Ø© Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª
      //flights.sort((a, b) => a.price - b.price);


      // ØªÙˆÙ„ÙŠØ¯ Ù‚ÙŠÙ… Ø¹Ø´ÙˆØ§Ø¦ÙŠØ© Ù„Ø¹Ø¯Ø¯ Ù…ÙˆØ§Ù‚Ø¹ Ø§Ù„Ø¨Ø­Ø« Ø§Ù„ØªÙ‰ ØªÙ… Ø¬Ù„Ø¨ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ù…Ù†Ù‡Ø§
      

      // ØªÙˆÙ„ÙŠØ¯ Ù…Ø­Ø·Ø§Øª Ø§Ù„ØªÙˆÙ‚Ù Ù„Ù„Ø±Ø­Ù„Ø§Øª ØºÙŠØ± Ø§Ù„Ù…Ø¨Ø§Ø´Ø±Ø©
      const steps = (stops) =>{
        let rs = ''
        if (stops.length > 0) {
        stops.forEach(stop=>{
          rs += `<span class="stop" data-stop="${stop}"></span>`
        })
      } else {
        rs=`<span class="direct">Ø±Ø­Ù„Ø© Ù…Ø¨Ø§Ø´Ø±Ø©</span>`
      }
        return rs;
      }

      // ØªØ±ØªÙŠØ¨ Ø§Ù„Ù…ØµÙÙˆÙØ© Ø¨Ø´ÙƒÙ„ Ø¹Ø´ÙˆØ§Ø¦Ù‰
      function shuffleArray(array) {
        // Create a copy of the array to avoid modifying the original
        const shuffledArray = [...array];
        // Use the Fisher-Yates shuffle algorithm
        for (let i = shuffledArray.length - 1; i > 0; i--) {
          const j = Math.floor(Math.random() * (i + 1)); // Random index between 0 and i (inclusive)
          [shuffledArray[i], shuffledArray[j]] = [shuffledArray[j], shuffledArray[i]]; // Swap elements
        }
        return shuffledArray;
      }
      const numbers = [1, 2, 3, 4, 5, 6, 7, 8, 9, 10];

      ////////////////////////////////////////


      const rendered_results = (flights) => {
        const res = flights.map ((flight, i)=>{
          const index = randomNumber(0, airlines.length)
          const alp = airlines[index]
        const weekDay = new Date(departure_date)
        const grade =   'ECO'
        const flightPrice = pricing[getDayName(weekDay)][grade]*alp.ratio
        
        const stops = flight.stops.map((stop)=>{ return '<span class="stop" data-stop="'+stop+'"></span>'})
        
        return `
          <div class="result">
            <a class="result-info">
              <div class="row result-wrapper">
                <div class="col col-3" style="border-left: 1px solid #ccc">
                  <div class="airline-provider p-3 ">
                    <p class="text-center">
                      <img class="d-block m-auto" src="${alp.logo}" alt="" height="50" /></p>
                    <p class="provider-name">${alp.name}</p>
                  </div>
                </div>
                <div class="col col-6 ">
                  <div class="flight-details p-3 ">
                    <div class="line"></div>
                    <div class="timing">
                      <span class="start" data-time="${flight['departureTime']}" data-airport="${departure.IATA}" title="${departure.name}"></span>
                      <span class="stops text-center" data-period="ğŸ•“ ${flight.duration[0]} Ø³ØŒ ${flight.duration[1]} Ø¯">
                        ${steps(flight.stops)}
                      </span>
                      <span class="end" data-time="${flight['arrivalTime']}" data-airport="${destination.IATA}" title="${destination.name}"></span>
                    </div>
                  </div>
                </div>
                <div class="pricing col col-3 p-0">
                  <div class="flight-pricing text-center p-0">
                    <button class="btn">Ù†Ù†ØµØ­ Ø¨Ù‡Ø§</button>
                    <p class=" results-from-websites my-0 py-0 text-center"><small>Ø§Ù„Ù†ØªØ§Ø¦Ø¬ Ù…Ù† ${randomNumber(1, 10)} Ù…ÙˆØ§Ù‚Ø¹</small></p>
                    <p class="price text-center">
                      <span class="amount fw-bold py-0 my-0 fs-3">
                        ${flightPrice.toFixed(2)}
                      </span>
                      Ø¬ Ù…
                    </p>
                    <p class="price-info py-0 my-0 text-center">Ù„Ù„ÙØ±Ø¯ Ø´Ø§Ù…Ù„Ø© Ø§Ù„Ø¶Ø±ÙŠØ¨Ø©</p>
                  </div>
                </div>
              </div>
            </a>
          </div>
        `
      })
      return res;
    }

    const flights = generateFlights(randomNumber(10, 15));
    console.log(flights)
      $('#search-result').html(rendered_results(flights))


      function htmlEl(name, text, attr) {
        let el = document.createElement(name)
        el.innerHTML = text
        for (prop in attr) {
          el.setAttribute(prop, attr[prop])
        }
        return el
      }
      function renderFlights(element) {
        // $(element).appendChild(result)
        /*  */

      }

      $('.result-info').on('click', function () {
        $('body').addClass('freeze');
        $('.result-info-section').addClass('show')
      })
    </script>


  </body>
</html>